> 来源极客时间《DDD实战课》--欧创新

# 06 | 领域事件：解耦微服务的关键

**领域事件及实现**

领域事件是用来表示领域中发生的事件。一个领域事件将导致进一步的业务操作，在实现业务解耦的同时，还有助于形成完整的业务闭环。

领域事件的执行需要一系列的组件和技术来支撑。我们来看一下这个领域事件总体技术架构图（技术架构只作参考）。

![image-20220126223620367](https://gitee.com/yanglu_u/img2022/raw/master/learn/20220126223620.png)

主要技术包括：

1. 事件构建和发布：事件基本属性（包括事件唯一标识、发生时间、事件类型和事件源等）和业务属性一起构成事件实体，发布到消息中间件。
2. 事件数据持久化：事件数据持久化可用于系统之间的数据对账，当遇到系统宕机或者网络中断，在问题解决后仍可继续后续业务流转，保证数据的一致性。
3. 事件总线 (EventBus)：事件总线是进程内模型，如果同时存在微服务内和外订阅者，则先分发到内部订阅者并持久化，再异步发送到消息中间件。
4. 消息中间件。
5. 事件接收和处理。

**领域事件相关案例**

以保险承保业务过程为例，当前发生的领域事件是：缴费通知单已生成。下一步的业务操作是：缴费。

![image-20220126221726276](https://gitee.com/yanglu_u/img2022/raw/master/learn/20220126221726.png)

1. 投保微服务生成缴费通知单，发布第一个事件：缴费通知单已生成。
2. 收款微服务缴费完成后，发布第二个领域事件：缴费已完成。
3. 投保微服务在投保单转保单完成后，发布第三个领域事件：保单已生成。
4. 保单微服务完成保单数据保存后，后面还会发生一系列的领域事件，这里就不详细说了。

总之，通过领域事件驱动的异步化机制，可以推动业务流程和数据在各个不同微服务之间的流转。



