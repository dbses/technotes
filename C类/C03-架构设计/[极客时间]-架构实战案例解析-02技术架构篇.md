> 来源：极客时间《架构实战案例解析》

# 11 | 技术架构：作为开发，你真的了解系统吗？

这一讲，我想先跟你聊聊技术架构要解决什么问题。

**系统的物理模型**

我们先看下一个系统的具体组成。

![image-20220407222249265](https://technotes.oss-cn-shenzhen.aliyuncs.com/2022/202204072222960.png)

从用户请求的处理过程来看，系统主要包括五大部分。

- 接入系统

它负责接收用户的请求，然后把用户的请求分发到某个 Web 服务器进行处理。

- 应用系统

我们是基于某个开发框架来开发应用的，比如 Java 应用一般是基于 Spring MVC 框架；我们的应用代码，会调用开发语言提供的库和各种第三方的库，比如 JDK 和 Log4j。

- 基础平台

首先是各个语言的运行时，比如说 JVM；然后是容器或虚拟机；下面还有操作系统；最底下就是硬件和网络。

- 核心组件

在大多数情况下，应用系统还要借助大量外部的中间件来实现功能和落地数据，比如数据库、缓存、消息队列，以及 RPC 通讯框架等等。

- 支撑系统

包括日志系统、配置系统，还有大量的运维系统，它们提供监控、安全、资源调度等功能，它们和核心组件的区别是，这些系统一般不参与实际的用户请求处理，但它们在背后默默保障系统的正常运行。

**技术架构的挑战**

- 硬件的问题

从技术架构的角度，提升硬件的处理能力一般有两种方式：Scale Up 和 Scale Out。

垂直扩展有物理上的瓶颈或成本的问题。受硬件的物理限制，机器的性能是有天花板的。水平扩展如何有效地管理大量的机器，硬件不是 100% 的可靠，它本身也会出问题。

我们在做技术架构设计时，就要充分考虑各种硬件故障的可能性，做好应对方案。比如说针对自然灾害，系统做异地多机房部署。

- 软件的问题

这里的软件，主要说的是各种中间件和系统级软件。软件在填硬件的各种坑的同时，也给系统挖了新的坑。

举个例子，Redis 集群的多节点，它解决了单节点处理能力问题，但同时也带来了新的问题，比如节点内部的网络有问题（即网络分区现象），集群的可用性就有问题；Redis 数据的多副本，它解决了单台服务器故障带来的可用性问题，但同时也带来了数据的一致性问题。

**技术架构的目标**

什么是系统非功能性需求呢？比如一个订单页面打开需要多少时间，页面是不是每次都能打开，这些就和具体的业务逻辑没有关系，属于系统非功能性需求的范畴。

对于一个系统来说，技术架构都要解决哪些非功能性需求呢？

- 系统的高可用

导致系统可用性出问题，一般是两种情况：一种是软硬件本身有故障，比如机器断电，网络不通；

还有一种是高并发引起的系统处理能力的不足，软硬件系统经常在处理能力不足时，直接瘫痪掉，比如 CPU 100% 的时候，整个系统完全不工作。

- 系统的高性能

保证合理的性能分两种情况：一种是常规的流量进来，但系统内部处理比较复杂，我们就需要运用技术手段进行优化。比如针对海量商品的检索，我们就需要构建复杂的搜索系统来支持。

第二种是高并发的流量进来，系统仍旧需要在合理的时间内提供响应，这就更强调我们做架构设计时，要保证系统的处理能力能够整体上做水平扩展，而不仅仅是对某个节点做绝对的性能优化，因为流量的提升是很难准确预计的。

- 系统的可伸缩和低成本

我们的架构设计要保证系统在业务高峰时，要能快速地增加资源来提升系统处理能力；反之，当业务低谷时，可以快速地减少系统资源，保证系统的低成本。





