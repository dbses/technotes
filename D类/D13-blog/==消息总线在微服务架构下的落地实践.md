

## 前言

## 面临的问题

当前电商平台采用了微服务架构，服务之间依赖较重，耦合度较高。



## 解决方案

消息队列的作用：削峰填谷、异步、解耦。

![image-20201203172036177](https://technotes.oss-cn-shenzhen.aliyuncs.com/2021/image-20201203172036177.png)

这种架构面临以下问题：

1. 开发成本大：开发团队成员都需要对 Kafka 技术有一定的了解；
2. 管理难度大：各团队使用不当时，没有办法了解问题原因；
3. 监控难度大：当前只有对 Kafka 集群简单的监控功能；
4. 运维困难：遇到线上消息没有消费时，很难排查问题，无从下手；
5. 升级难度大：Kafka-Client 需要升级时，涉及到服务太多，导致升级成本高；

### 消息总线总体方案

面对上面问题，采用消息总线服务的方式进行优化。

![image-20201203172323761](https://technotes.oss-cn-shenzhen.aliyuncs.com/2021/image-20201203172323761.png)

消息总线服务隐藏了消息发送、必送必达、路由、分组、过滤、存储、高可用等一系列问题。

### 消息流转过程

![worddav61d30eb04c51da0708506410522f66eb](https://technotes.oss-cn-shenzhen.aliyuncs.com/2021/worddav61d30eb04c51da0708506410522f66eb.png)



### 补偿机制

失败重试、自动补偿、手动补偿。

### 监控与告警



## 落地与实践

### 源码篇

原理图示。专篇细讲

### 数据库篇

表结构图示。专篇细讲

## 开源

