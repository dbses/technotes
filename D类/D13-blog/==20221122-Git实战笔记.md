# 删除指定commit

假如某个项目当中有 3 条提交。

```
commit-3  bc3ce563
commit-2  b9c7e5c2
commit-1  5a480a4b
```

现在我们要删除`commit-2`这条提交记录。

第一步：使用`git reflog`查看提交信息

```
git reflog
```

![image-20221122164046629](https://technotes.oss-cn-shenzhen.aliyuncs.com/2022/image-20221122164046629.png)

第二步：`rebase`操作

```
git rebase -i 5a480a4b
```

执行完这个命令后，就可以看到 `5a480a4b` 后的所有 commit 记录。

![image-20221122164151329](https://technotes.oss-cn-shenzhen.aliyuncs.com/2022/image-20221122164151329.png)

把原本的`pick`单词修改为`drop`就表示该ID对应的 commit log 我们需要删除。vim 保存退出。

第三步：解决冲突，强制推送更新到远程

```
git add .                   # 冲突时使用
git commit -m "new commit"  # 冲突时使用
git rebase --continue       # 冲突时使用
git push origin master -f
```

再查看远程的提交记录，发现`commit-2`就没有了。

# 修改历史提交人信息

```
git config --local user.name 'studeyang'
git config --local user.email 'yanglu_u@126.com'
```

```
git filter-branch -f --env-filter '
OLD_EMAIL="原来的邮箱"
CORRECT_NAME="studeyang"
CORRECT_EMAIL="yanglu_u@126.com"
if [ "$GIT_COMMITTER_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_COMMITTER_NAME="$CORRECT_NAME"
    export GIT_COMMITTER_EMAIL="$CORRECT_EMAIL"
fi
if [ "$GIT_AUTHOR_EMAIL" = "$OLD_EMAIL" ]
then
    export GIT_AUTHOR_NAME="$CORRECT_NAME"
    export GIT_AUTHOR_EMAIL="$CORRECT_EMAIL"
fi
' --tag-name-filter cat -- --branches --tags
```

