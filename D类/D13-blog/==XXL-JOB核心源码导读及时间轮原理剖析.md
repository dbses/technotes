介绍一下XXL-JOB，架构图如下。



首先执行器要向服务端注册。那么这里你可能就有疑问了，执行器向服务端注册？怎么注册的？多久注册一次？采用什么通信协议？

然后，服务端才能知道有哪些执行器，并触发任务调度。那么服务端是如何记录每个任务的触发时机，并完成精准调度的呢？

最后，执行器接收到调度请求，是怎么执行任务的呢？线程池？

本文内容较干，请搭配源码食用。

## 时间轮

秒针嘀嗒式的时钟，

秒针流动式的时钟，

了解了时间轮原理，其实任务调度的精准度是取决于时间轮的刻度的。举个例子，我们把 0 秒时刻的这 1s 拆成 1000ms。

![image-20221129112041689](https://technotes.oss-cn-shenzhen.aliyuncs.com/2022/image-20221129112041689.png)

假高任务都是在第 500ms 完成该时刻秒内所有任务的调度的，501ms 有一个新的任务被预读线程加载进来了，那么轮到下次调度，就要等到第 1 秒时刻的第 500ms，误差相差了一个刻度即 1s。

所以说，刻度越小，误差越小。不过这也要根据业务的实际情况来决定，毕竟要想减少误差，就要耗费更多的 CPU 资源。



> 推广方案：XXL-JOB你有使用过吗？这些问题你能答上来吗？